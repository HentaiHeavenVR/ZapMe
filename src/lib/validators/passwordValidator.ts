const CommonBadPasswordRegex = /^(?:(?:(?:\d+|.{1,3})?(?:.assword|p.ssword|pa.sword|pas.word|pass.ord|passw.rd|passwo.d|passwor.|(?:qw|qwe|qwer|qwert|qwerty|qwertyuiop)?(?:as|asd|asdf|asdfg|asdfgh|asdfghjkl)?(?:zx|zxc|zxcv|zxcvb|zxcvbn|zxcvbnm)?)+(?:\d+|.{1,3})?|(.{1,6})\1+)|\d*.{1,5}\d*)$/;
const ReallyBadPasswords = new Set(["homelesspa","fqrg7cs493","basketball","vqsablpzla","cjmasterinf","diosesfiel","tinkerbell","hellokitty","startfinding","manchester","california","uqa9ebw445","yagjecc826","sz9kqcctwy","justinbieb","friendster","strawberry","azertyuiop","christopher","undertaker","sweetheart","3d8cubaj2e","realmadrid","linkinpark","alessandro","w5txn36alfw","bestfriend","volleyball","terminator","poiuytrewq","motdepasse","harrypotter","christophe","diwtgm8492","jesuschrist","dragonball","telechargement","vrbgqns997","golfcourse","ilovejesus","friendship","blackberry","ka_djkhjsy6","skateboard","tokiohotel","watermelon","qazwsxedcrfv","ronaldinho","prettygirl","5hsu75kpot","cinderella","alessandra","casablanca","enterprise","ocpoook325","butterfly2","youngmoney","underground","daddysgirl","washington","spiderman3","callofduty","september2","5xfgs3ii9d","y6p67ftrqj","lighthouse","skate4life","nuttertools","ironmaiden","revolution","motherlode","galatasaray","webhompass","smallville","playstation","justinbieber","vaffanculo","godisgreat","maprchem56458","iloveyou22","motherfucker","chrisbrown","spiderman2","aleksandra","university","mastermind","abcdefghij","jesusislord","uvgx8f8232","iamthebest","jesucristo","mississippi","opensesame","fenerbahce","international","information","d9zufqd92n","ilovemymom","felicidade","3rjs5la8qe","football22","jacqueline","chocolate2","temppassword","elizabeth2","ilovemyself","fktrcfylhf","losangeles","wachtwoord","spongebob2","syncmaster","professional","qdujvyg5sxa","bangladesh","abracadabra","yfdbufnjh63","7ugd5hip2j","whatthezor","summertime","c43qpul5rz","cm6e7aumn9","roadrunner","anastasiya","butterfly7","football23","sailormoon","alexandria","evangelion","dragonballz","viphv5j736","suckmydick","moneymaker","matematica","nintendo64","leavemealone","mickeymouse","hellothere","fuckyou666","mechanical","jesuschris","hondacivic","cheesecake","television","baseball22","maximilian","jesussaves","juancarlos","puertorico","92k2cizcdp","abrakadabra","administrator","finalfantasy","ilovemusic","cepetsugih","braveheart","diosesamor","simpleplan","iloveyou69","bernadette","hollister2","wonderland","lamborghini","iloveyou23","d2xyw89sxj","multiplelog","konstantin","estrellita","alexander2","girlfriend","projectsadminx","highlander","volkswagen","uhfybn8888","ichliebedich","baseball23","jesusfreak","wellington","ilovechris","huhbbhzu78","loveislife","neveragain","kifj9n7bfu","sonyericsson","butterfly3","networking","princess22","astonvilla","madagascar","w66yrybgra","fullaccess","megasecret","ihatethisgame","playstation3","forzamilan","nodefinido","harrypotte","triskelion","liverpool8","mileycyrus","mississipp","helloworld","princess23","x3luym2mmj","lifeisgood","rjycnfynby","s8ylpe9jdpvym","baseball24","princesita","principessa","football24","ghostrider","pok29q6666","ordinateur","deutschland","margherita","tweetybird","motherfuck","ilovepussy","bellissima","evanescence","winchester","babygirl23","technology","music4life","battlefield","owt243ygbj","liverpoolfc","mostwanted","sunderland","cookiemons","livestrong","bestfriends","christian2","management","monkeybutt","kobebryant","babygirl69","jaihanuman","september9","mitsubishi","revelation","klapaucius","h2vwdubjx4","everything","beautiful2","scvmofas79","ilovejusti","seniseviyorum","sagitarius","forzainter","magandaako","christelle","maryjane42","w5tn36alfw","babygirl22","supersonic","onedirection","septiembre","underworld","7elephants","slipknot66","gymnastics","montecarlo","firefighter","murcielago","butterfly8","history278","deerhunter","mylinkedin","qwertzuiop","dontforget","friendofemily","devilmaycry","8phrowz624","impossible","heartbreak","superman23","grenouille","liverpool9","lucifer666","godlovesme","teamomucho","december25","ilovemysel","transformers","minicooper","supermario","kingfisher","pathfinder","football33","supernatural","fiorentina","sonnenschein","computador","madagaskar","l6ho3tg7wb","gribouille","multimedia","serendipity","yjdsqgfhjkm","football32","sanandreas","iloveindia","football55","darthvader","trustnoone","liverpool2","challenger","villanueva","birmingham","limpbizkit","slipknot666","armageddon","qawsedrftg","salamander","football44","loveforever","mickeymous","disneyland","football25","astonmartin","baseball25","chocolate7","elsalvador","needforspeed","jfgvcqbuzug","blood4life","backstreet","jesuscristo","iloveyouba","shevchenko","migrationschool","calculator","highschool","peanutbutter","butterfly6","loveu4ever","vfntvfnbrf","chocolate3","godblessme","contrasena","quiksilver","hilaryduff","riverplate","intermilan","whatthefuck","scoobydoo2","xblhintb9w","olamilekan","r9lw4j8khx","starcraft2","fuckmylife","constantin","holyspirit","need4speed","friends4ev","princess69","elizabeth3","falloutboy","ilovemybab","spongebob3","fuckyoubit","fantastic4","cristiano7","newzealand","elisabetta","crazybitch","musiclover","allahuakbar","gunsnroses","olanrewaju","gettherefast","heavymetal","solidsnake","countryboy","liverpool5","football34","princess24","clementine","butterfly9","myspace4me","internazionale","salamandra","goldfinger","bvp33w7epu","football69","3daysgrace","friendofjoan","rbotmvz954","5plk4l5uc7","thebeatles","coccinella","tzir25l5kn","harekrishna","electrical","ilovemykids","cocksucker","playstation2","jesusloves","generation","johnnydepp","kurtcobain","flatblocker","skyliner34","realestate","football99","butterfly5","matematika","softball22","antoinette","cheerleader","stephanie2","elizabeth7","metallica2","yu5l97wk8q","blackwater","superman69","thunderbird","psychology","ingodwetrust","arcobaleno","football77","sdf7asdf6asdg8df","successful","iloveyou24","applesauce","rememberme","3qdlqb49js","brownsugar","dramaqueen","htubcnhfwbz","philippine","timberland","bigbrother","id6c3wr6un","psicologia","accounting","football88","playstatio","michaeljac","cheerleade","ilovemymum","schumacher","butterfly4","hgrfqg4577","flowerpower","runescape2","minicalibra","ghhh47hj7649","apocalypse","dictionary","bobesponja","coregmedia","southside3","sunshine22","friendofgerly","ilovemydad","prosperity","ilovemyfam","greedisgood","connection","employment","ilovegirls","steelers43","superduper","copenhagen","motorcycle","november23","independent","undercover","marguerite","demilovato","astalavista","maplestory","tigerwoods","brokenhear","amdturion64","sweetiepie","ilovemykid","november22","telecaster","sacramento","earnhardt3","aleksander","crepusculo","wsbe279qsg","perfection","ilovemylife","december22","chicharito","avrillavigne","hollywood2","minhasenha","afghanistan","superstar2","ilovemyfamily","confidence","montgomery","pittsburgh","spongebob9","transforme","kamehameha","capricornio","shakespeare","dragonfire","neworleans","poptropica","qwertyytrewq","liverpool7","fcbarcelona","timberlake","computadora","counterstrike","dkxjizc282","qugrqfo825","superman22","mathematics","dance4life","jesuslovesme","september3","sunshine69","babygirl24","newpasswor","ichliebedi","forzanapoli","millennium","lovelygirl","selenagome","googletester","rfhfvtkmrf","december23","jaigurudev","3s43pth5aea","alexander3","football54","stratocaster","allahakbar","electronics","hawkesbury93","nha7ebf6kp","hx28o9e646","gearsofwar","amoreterno","engineering","breakdance","guitarhero","pocahontas","fuckthewor","spiderman7","chocolate5","constantine","quicksilver","rockandroll","chinchilla","peppermint","football28","spongebob7","september8","elizabeth9","qazwsxedcrfvtgb","poopmaster","helicopter","spionin8688","elizabeth8","gtavicecity","iloveyou<3","myspacepas","football95","hellraiser","baseball33","fuckyouall","production","fuckmehard","staredobre","qpwoeiruty","karakartal","beethoven9","darkknight","gwarmonster","johncena54","ilovedavid","qazxswedcvfr","gossipgirl","supervisor","povlmly727","lovemykids","jordan2345","jesuslives","vascorossi","jkiuztdftl57","iloveyoux3","familiyafamiliya","teddybear2","lebronjame","lightning2","skaterdude","randyorton","jiang8kevin","chocolate9","november25","allrecipes","icxkyb7972","september7","painkiller","mamikawada","christmas2","sweetangel","doggystyle","cheguevara","superwoman","letmeinnow","yggdrasil4","ss563563ss","nomeacuerdo","cxfcnkbdfz","richardson","natiichen999","basketbal9","maximiliano","chocolate8","incredible","hannover96","sexybitch2","football27","kinomoto89","kartoffelpuffer","nickiminaj","iloveyouso","alejandro2","hannahmontana","tuputamadre","kissmyass2","hans4queck","football56","barbiegirl","honeybunny","hollister3","ghbdtnrfrltkf","angelseye22","farfallina","hannahmont","southside2","2kroliczek","chocolate4","wpcakir264","whitetiger","november24","weyersheim","depechemode","armorgames","santamaria","moderncombat","christina2","november27","december28","somanypickles27","monstercha","nottingham","softball23","rangerover","przyjaciolki","christian7","butterball","iloveyou88","goodmorning","yaoiisgrand","phoenix888","lovehurts2","unforgiven","cosmopolitan","ibicguwjic","heartbroke","illuminati","emmanuelle","marvel5454","butterflies","2pacshakur","salmankhan","skateordie","almario927","heterosexual","concepcion","edwardcullen","meatball99","krystyna56","fallen_angel","knackwurst8853","istanbul34","independen","accountant","michaeljackson","electronic","pinkpanther","spiderman4","pakistan786","poiuytreza","timfranzke","metallica6","wonderwoman","nickelback","schokolade","redemption","josemanuel","football45","silverkey3","ledzeppelin","abercrombie","foundation","299kgj8hgf","trapdoor39","fenohasina39","november26","sunshine23","elizabeth5","forgetmenot","dimas34rus","brinchen23","fgjrfkbgcbc34","kretsaha53","manchesterunited","vladcherktecktonik","huangfeisuny","littlegirl","yfnfitymrf","kirik26trimyasov","japanese92","jesus4life","nevergiveup","aquamarine","spongebob5","rolandia42","jonasbroth","alexander7","moneyman87","jesus4ever","donaldduck","etnxtxsa65","iamawesome","zpaqrt2963","vflfufcrfh","martinique","shiningeagle","december24","nthvbyfnjh","ilovejames","blacksheep","november28","ilovemoney","december29","rubberduck","ghjcnjgfhjkm","8phrowz622","emmawatson","killerin66","kmzwa8awaa","grasshopper","caterpillar","residentevil","metropolis","littlebear","pussyeater","cookiemonster","princess25","owt243ygbh","zimmermann33","linkedin4me","ghjcnbnenrf","dei3mutter","whitepower","undergroun","elizabeth4","oluwatosin","peacemaker","hijodeputa","jellybeans","leedsunited","2q2w3e8r5t","3tutso24qf","valkenhayn","karappinha","mycomputer","qsdfghjklm","v3xafy4k3y","football42","sunflowers","sebastian2","sayangkamu","cincinnati","sunflower2","parliament","peanutbutt","gamemaster","christoph89","raumschiff","paintball2","philippines","spongebob4","jellybelly","hurricanes","cannondale","skelitor66","juliocesar","3doorsdown","lpz93ssskqw8q","justforfun","werilopert","celinesimon","qazwsxedcr","barbiedoll","mod7tygrysow","sanantonio","fripouille","masterchief","supermanboy","azsxdcfvgb","protection","fuckoff666","football52","lovemyself","december27","buttercup2","december26","nevertarget7","football66","nguyen4thewin","christian3","alphaomega","rottweiler","ð¼ð°ðºñð¸ð¼","k47rizxt2g","blackangel","drpepper23","burgerking","giuseppina","packardbell","iloveyou33","wildflower","baseball99","fucktheworld","november29","hammerhead","millionaire","taylorswif","communication","sonnenblume","fotografia","blackheart","badakhshan","hakunamatata","spiderman5","christine2","memyselfandi","michelle22","belladonna","ceckbrcerfkbxyjcnm2","hollister7","jediknight","2daughters","portsmouth","tombraider","hunnybunny","jackdaniels","oks65b6666","spongebob8","temptation","elenanesterova","dimafilippov","whatthefuc","jessejames","honeybunch","bellissimo","ernestsantikov","shirankova42","vitaminka88","maxpredator","vkuradovetc","mushroomka","yanchikchmoki","vkrbashyan","vfvfvskfhfve","princess99","baronessa87","olgastrashney","eremei_vasechkin","maksimka876","rtertuy77ijyhu7i","kotmichanik","volkovoi_net","strekoza79","maksimilian_nasirov","shukshinasveta","prosvirkind","soloveibormalei","kotya_bagdan","sivenkovklin","zarinalin87","taskaev777","borismf5tsh","maxonina22","stronghold","victorclavier","varduhigohar","vkravchenko","volkovanata77","supervista","wwwksenechkawww","kotovichvalentina","mknaxhxeh8yp3tf","kovalienko63","julia_eduardovna","vip_trading","bolshoj_zmej","vkoomare88","beloved_a_devil","yulianaz85","veralipatnikova","antonichmeli","zabolotneva_ira","nika_kisa88","kotikova_n_m","emo_limonad","opiumbaron","yuliasha87","bandidas747","sevgeyq9v7kor","ksushapanda","romka_ya93","jannaarhipova","burchenkovi","subprodukty","stone_mitich","ivankaterinchenko","mkolendzyan","gheniagabb","ser_kuzmin","victoria989","nastina33592","raskevichtanja","stepanov_georgij","razdvatri3","nikolay_thebest","mobiline_b","zabludshaya","asabsmelik5g","narashchivaiunoghti","mmakssimka","monp5haynes","prosto_chelkynchik","kirill999_97","mikhayildopy","simonova_lyudmila_73","matrassesotk","nataliystre","tyumchenko_ok","almaz_kiramov","volhsara56","renesmeecallen","zarygalina","shevcov_alesha","victorfrunz","ahmed_orudzhov","goderdzikarxjxv","helga_557634","moscowcallin","victor_evdokimov","manovitskaya","zabelinaalena","rendakova_sveta","rauzawcsiv","sorokina7778","maxchislov","siiifonjiknalivai","victoria_shkurco","sungatullinad","reginka2393","mishaghbdtn","kuchelaeva","stella354926","stas_kolos","andrei_rew","sukasbliat","vgizetdinov","sergey_brrr24","denis_nazarenko","pokopushkin","kirienko_svetlana","style_style","sophieytorf","komnatnyy88","oksanaorgadykova","varfeevich","ch_vitalij","egorov_maxim","qwertykolakola","svetlana26rus","mikalyalia","mariagoncharenko","galinka_korneeva","zarina_sabirova","piankova72"]);

function validatePassword(password: string): { valid: boolean; message: string | null } {
  if (password.length == 0) {
    return { valid: false, message: null };
  }
  if (password.length < 10) {
    return { valid: false, message: 'Password is too short' };
  }
  if (password.length > 256) {
    return { valid: false, message: `Seriously? ${password.length} characters? That's too much` }; 
  }
  const trimmedLength = password.trim().length;
  if (trimmedLength == 0) {
    return { valid: false, message: 'Password cannot consist of only whitespaces' };
  }
  if (trimmedLength != password.length) {
    return { valid: false, message: 'Password cannot start or end with whitespace' };
  }
  if (CommonBadPasswordRegex.test(password) || ReallyBadPasswords.has(password)) {
    return { valid: false, message: 'This password is really bad™' };
  }

  return { valid: true, message: null };
}

export { validatePassword };